
Using cuda device
Logging to runs/v1/PPO_2
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 1.48e+03 |
|    ep_rew_mean     | 8        |
| time/              |          |
|    fps             | 11       |
|    iterations      | 1        |
|    time_elapsed    | 701      |
|    total_timesteps | 8192     |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.3e+03     |
|    ep_rew_mean          | 5.33        |
| time/                   |             |
|    fps                  | 13          |
|    iterations           | 2           |
|    time_elapsed         | 1219        |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.007505258 |
|    clip_fraction        | 0.0667      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.94       |
|    explained_variance   | 0.0825      |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0117     |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.00466    |
|    value_loss           | 0.189       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 2.51e+03    |
|    ep_rew_mean          | 2.67        |
| time/                   |             |
|    fps                  | 13          |
|    iterations           | 3           |
|    time_elapsed         | 1815        |
|    total_timesteps      | 24576       |
| train/                  |             |
|    approx_kl            | 0.014033921 |
|    clip_fraction        | 0.142       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.93       |
|    explained_variance   | 0.103       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00838    |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.0122     |
|    value_loss           | 0.00223     |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 2.4e+03     |
|    ep_rew_mean          | 2.29        |
| time/                   |             |
|    fps                  | 13          |
|    iterations           | 4           |
|    time_elapsed         | 2360        |
|    total_timesteps      | 32768       |
| train/                  |             |
|    approx_kl            | 0.014387997 |
|    clip_fraction        | 0.165       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.91       |
|    explained_variance   | 0.714       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.034      |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.0124     |
|    value_loss           | 0.000526    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3.18e+03    |
|    ep_rew_mean          | 2           |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 5           |
|    time_elapsed         | 2901        |
|    total_timesteps      | 40960       |
| train/                  |             |
|    approx_kl            | 0.011772199 |
|    clip_fraction        | 0.153       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.88       |
|    explained_variance   | 0.693       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0233     |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.0164     |
|    value_loss           | 0.000274    |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 3.18e+03   |
|    ep_rew_mean          | 2          |
| time/                   |            |
|    fps                  | 14         |
|    iterations           | 6          |
|    time_elapsed         | 3423       |
|    total_timesteps      | 49152      |
| train/                  |            |
|    approx_kl            | 0.01493161 |
|    clip_fraction        | 0.198      |
|    clip_range           | 0.2        |
|    entropy_loss         | -1.86      |
|    explained_variance   | 0.775      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0396    |
|    n_updates            | 50         |
|    policy_gradient_loss | -0.0231    |
|    value_loss           | 0.000148   |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3.87e+03    |
|    ep_rew_mean          | 1.6         |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 7           |
|    time_elapsed         | 3998        |
|    total_timesteps      | 57344       |
| train/                  |             |
|    approx_kl            | 0.018072639 |
|    clip_fraction        | 0.221       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.84       |
|    explained_variance   | 0.801       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0361     |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.0209     |
|    value_loss           | 5.82e-05    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 4.26e+03    |
|    ep_rew_mean          | 1.33        |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 8           |
|    time_elapsed         | 4575        |
|    total_timesteps      | 65536       |
| train/                  |             |
|    approx_kl            | 0.019609604 |
|    clip_fraction        | 0.236       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.82       |
|    explained_variance   | 0.635       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0633     |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0271     |
|    value_loss           | 2.62e-05    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 4.18e+03    |
|    ep_rew_mean          | 1           |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 9           |
|    time_elapsed         | 5204        |
|    total_timesteps      | 73728       |
| train/                  |             |
|    approx_kl            | 0.020131914 |
|    clip_fraction        | 0.22        |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.81       |
|    explained_variance   | 0.728       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0615     |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.0261     |
|    value_loss           | 1.27e-05    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 4.06e+03    |
|    ep_rew_mean          | 0.941       |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 10          |
|    time_elapsed         | 5763        |
|    total_timesteps      | 81920       |
| train/                  |             |
|    approx_kl            | 0.020163726 |
|    clip_fraction        | 0.262       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.78       |
|    explained_variance   | 0.76        |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0417     |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.032      |
|    value_loss           | 7.58e-06    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3.74e+03    |
|    ep_rew_mean          | 0.842       |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 11          |
|    time_elapsed         | 6337        |
|    total_timesteps      | 90112       |
| train/                  |             |
|    approx_kl            | 0.022110803 |
|    clip_fraction        | 0.249       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.77       |
|    explained_variance   | 0.412       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0164     |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.0139     |
|    value_loss           | 7.66e-06    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3.74e+03    |
|    ep_rew_mean          | 0.842       |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 12          |
|    time_elapsed         | 6865        |
|    total_timesteps      | 98304       |
| train/                  |             |
|    approx_kl            | 0.019347394 |
|    clip_fraction        | 0.231       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.73       |
|    explained_variance   | 0.00717     |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0413     |
|    n_updates            | 110         |
|    policy_gradient_loss | -0.0182     |
|    value_loss           | 0.000633    |
-----------------------------------------
Traceback (most recent call last):
  File "/home/dang/.local/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-2-c58b79926333>", line 165, in <module>
    model.learn(total_timesteps=4000000)  # 2m steps is about 8h at 70 FPS
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/stable_baselines3/ppo/ppo.py", line 308, in learn
    reset_num_timesteps=reset_num_timesteps,
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 234, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 175, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 162, in step
    return self.step_wait()
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 49, in step_wait
    obs = self.envs[env_idx].reset()
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/gym/wrappers/record_episode_statistics.py", line 17, in reset
    observation = super(RecordEpisodeStatistics, self).reset(**kwargs)
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/gym/core.py", line 237, in reset
    return self.env.reset(**kwargs)
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/gym/core.py", line 289, in reset
    return self.env.reset(**kwargs)
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/gym/core.py", line 264, in reset
    observation = self.env.reset(**kwargs)
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/gym/wrappers/time_limit.py", line 25, in reset
    return self.env.reset(**kwargs)
  File "/home/dang/.local/lib/python3.7/site-packages/minerl/env/_singleagent.py", line 22, in reset
    multi_obs = super().reset()
  File "/home/dang/.local/lib/python3.7/site-packages/minerl/env/_multiagent.py", line 476, in reset
    return self._peek_obs()
  File "/home/dang/.local/lib/python3.7/site-packages/minerl/env/_multiagent.py", line 634, in _peek_obs
    obs = instance.client_socket_recv_message()
  File "/home/dang/.local/lib/python3.7/site-packages/minerl/env/malmo.py", line 458, in client_socket_recv_message
    return comms.recv_message(self.client_socket)
  File "/home/dang/.local/lib/python3.7/site-packages/minerl/env/comms.py", line 63, in recv_message
    lengthbuf = recvall(sock, 4)
  File "/home/dang/.local/lib/python3.7/site-packages/minerl/env/comms.py", line 73, in recvall
    newbuf = sock.recv(count)
