
Logging to runs/v1/PPO_36
------------------------------
| time/              |       |
|    fps             | 49    |
|    iterations      | 1     |
|    time_elapsed    | 206   |
|    total_timesteps | 10240 |
------------------------------
---------------------------------------
| time/                   |           |
|    fps                  | 62        |
|    iterations           | 2         |
|    time_elapsed         | 325       |
|    total_timesteps      | 20480     |
| train/                  |           |
|    approx_kl            | 0.4367811 |
|    clip_fraction        | 0.705     |
|    clip_range           | 0.2       |
|    entropy_loss         | -3.51     |
|    explained_variance   | -26.8     |
|    learning_rate        | 0.0003    |
|    loss                 | -0.0908   |
|    n_updates            | 500       |
|    policy_gradient_loss | -0.0429   |
|    value_loss           | 1.36e-07  |
---------------------------------------
----------------------------------------
| time/                   |            |
|    fps                  | 69         |
|    iterations           | 3          |
|    time_elapsed         | 443        |
|    total_timesteps      | 30720      |
| train/                  |            |
|    approx_kl            | 0.36994353 |
|    clip_fraction        | 0.687      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.56      |
|    explained_variance   | -22.8      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0948    |
|    n_updates            | 510        |
|    policy_gradient_loss | -0.0558    |
|    value_loss           | 4.33e-08   |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 6.82e+03   |
|    ep_rew_mean          | 0          |
| time/                   |            |
|    fps                  | 69         |
|    iterations           | 4          |
|    time_elapsed         | 585        |
|    total_timesteps      | 40960      |
| train/                  |            |
|    approx_kl            | 0.37178615 |
|    clip_fraction        | 0.689      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.61      |
|    explained_variance   | -35.6      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.129     |
|    n_updates            | 520        |
|    policy_gradient_loss | -0.0629    |
|    value_loss           | 6.09e-08   |
----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 8.52e+03  |
|    ep_rew_mean          | 0         |
| time/                   |           |
|    fps                  | 66        |
|    iterations           | 5         |
|    time_elapsed         | 773       |
|    total_timesteps      | 51200     |
| train/                  |           |
|    approx_kl            | 0.2851049 |
|    clip_fraction        | 0.66      |
|    clip_range           | 0.2       |
|    entropy_loss         | -3.67     |
|    explained_variance   | -29       |
|    learning_rate        | 0.0003    |
|    loss                 | -0.0758   |
|    n_updates            | 530       |
|    policy_gradient_loss | -0.0698   |
|    value_loss           | 4.82e-08  |
---------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 7.58e+03   |
|    ep_rew_mean          | 0          |
| time/                   |            |
|    fps                  | 66         |
|    iterations           | 6          |
|    time_elapsed         | 918        |
|    total_timesteps      | 61440      |
| train/                  |            |
|    approx_kl            | 0.38446197 |
|    clip_fraction        | 0.695      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.68      |
|    explained_variance   | -1.79      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.13      |
|    n_updates            | 540        |
|    policy_gradient_loss | -0.077     |
|    value_loss           | 2.86e-08   |
----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 7.58e+03  |
|    ep_rew_mean          | 0         |
| time/                   |           |
|    fps                  | 69        |
|    iterations           | 7         |
|    time_elapsed         | 1038      |
|    total_timesteps      | 71680     |
| train/                  |           |
|    approx_kl            | 0.5378665 |
|    clip_fraction        | 0.721     |
|    clip_range           | 0.2       |
|    entropy_loss         | -3.51     |
|    explained_variance   | -2.96     |
|    learning_rate        | 0.0003    |
|    loss                 | -0.145    |
|    n_updates            | 550       |
|    policy_gradient_loss | -0.0826   |
|    value_loss           | 2.62e-07  |
---------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 7.58e+03  |
|    ep_rew_mean          | 0         |
| time/                   |           |
|    fps                  | 70        |
|    iterations           | 8         |
|    time_elapsed         | 1161      |
|    total_timesteps      | 81920     |
| train/                  |           |
|    approx_kl            | 0.5211279 |
|    clip_fraction        | 0.715     |
|    clip_range           | 0.2       |
|    entropy_loss         | -3.52     |
|    explained_variance   | -18       |
|    learning_rate        | 0.0003    |
|    loss                 | -0.131    |
|    n_updates            | 560       |
|    policy_gradient_loss | -0.0715   |
|    value_loss           | 3.13e-08  |
---------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 9.32e+03   |
|    ep_rew_mean          | 0          |
| time/                   |            |
|    fps                  | 69         |
|    iterations           | 9          |
|    time_elapsed         | 1329       |
|    total_timesteps      | 92160      |
| train/                  |            |
|    approx_kl            | 0.44814858 |
|    clip_fraction        | 0.705      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.5       |
|    explained_variance   | -35.2      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0879    |
|    n_updates            | 570        |
|    policy_gradient_loss | -0.0652    |
|    value_loss           | 1.96e-08   |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 9.41e+03   |
|    ep_rew_mean          | 0          |
| time/                   |            |
|    fps                  | 69         |
|    iterations           | 10         |
|    time_elapsed         | 1469       |
|    total_timesteps      | 102400     |
| train/                  |            |
|    approx_kl            | 0.36248225 |
|    clip_fraction        | 0.668      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.56      |
|    explained_variance   | -25.7      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.127     |
|    n_updates            | 580        |
|    policy_gradient_loss | -0.0618    |
|    value_loss           | 4.94e-08   |
----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 8.7e+03   |
|    ep_rew_mean          | 0         |
| time/                   |           |
|    fps                  | 68        |
|    iterations           | 11        |
|    time_elapsed         | 1633      |
|    total_timesteps      | 112640    |
| train/                  |           |
|    approx_kl            | 0.3762726 |
|    clip_fraction        | 0.695     |
|    clip_range           | 0.2       |
|    entropy_loss         | -3.58     |
|    explained_variance   | -14.3     |
|    learning_rate        | 0.0003    |
|    loss                 | -0.0965   |
|    n_updates            | 590       |
|    policy_gradient_loss | -0.0634   |
|    value_loss           | 7.97e-08  |
---------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 8.1e+03    |
|    ep_rew_mean          | 0          |
| time/                   |            |
|    fps                  | 67         |
|    iterations           | 12         |
|    time_elapsed         | 1815       |
|    total_timesteps      | 122880     |
| train/                  |            |
|    approx_kl            | 0.37946996 |
|    clip_fraction        | 0.679      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.54      |
|    explained_variance   | -24.2      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0952    |
|    n_updates            | 600        |
|    policy_gradient_loss | -0.0611    |
|    value_loss           | 7.91e-08   |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 8.1e+03    |
|    ep_rew_mean          | 0          |
| time/                   |            |
|    fps                  | 68         |
|    iterations           | 13         |
|    time_elapsed         | 1933       |
|    total_timesteps      | 133120     |
| train/                  |            |
|    approx_kl            | 0.44238567 |
|    clip_fraction        | 0.692      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.51      |
|    explained_variance   | -3.91      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.112     |
|    n_updates            | 610        |
|    policy_gradient_loss | -0.0717    |
|    value_loss           | 2.65e-08   |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 8.18e+03   |
|    ep_rew_mean          | 0          |
| time/                   |            |
|    fps                  | 69         |
|    iterations           | 14         |
|    time_elapsed         | 2075       |
|    total_timesteps      | 143360     |
| train/                  |            |
|    approx_kl            | 0.36277378 |
|    clip_fraction        | 0.69       |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.52      |
|    explained_variance   | -16.3      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.113     |
|    n_updates            | 620        |
|    policy_gradient_loss | -0.0669    |
|    value_loss           | 1.93e-08   |
----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 7.94e+03  |
|    ep_rew_mean          | 0         |
| time/                   |           |
|    fps                  | 69        |
|    iterations           | 15        |
|    time_elapsed         | 2219      |
|    total_timesteps      | 153600    |
| train/                  |           |
|    approx_kl            | 0.3883323 |
|    clip_fraction        | 0.691     |
|    clip_range           | 0.2       |
|    entropy_loss         | -3.54     |
|    explained_variance   | -24.6     |
|    learning_rate        | 0.0003    |
|    loss                 | -0.108    |
|    n_updates            | 630       |
|    policy_gradient_loss | -0.0634   |
|    value_loss           | 2.38e-08  |
---------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 7.67e+03  |
|    ep_rew_mean          | 0         |
| time/                   |           |
|    fps                  | 67        |
|    iterations           | 16        |
|    time_elapsed         | 2410      |
|    total_timesteps      | 163840    |
| train/                  |           |
|    approx_kl            | 0.4759013 |
|    clip_fraction        | 0.685     |
|    clip_range           | 0.2       |
|    entropy_loss         | -3.53     |
|    explained_variance   | -26.6     |
|    learning_rate        | 0.0003    |
|    loss                 | -0.0724   |
|    n_updates            | 640       |
|    policy_gradient_loss | -0.0536   |
|    value_loss           | 4.62e-08  |
---------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 7.67e+03  |
|    ep_rew_mean          | 0         |
| time/                   |           |
|    fps                  | 68        |
|    iterations           | 17        |
|    time_elapsed         | 2528      |
|    total_timesteps      | 174080    |
| train/                  |           |
|    approx_kl            | 0.3187726 |
|    clip_fraction        | 0.671     |
|    clip_range           | 0.2       |
|    entropy_loss         | -3.57     |
|    explained_variance   | -19.1     |
|    learning_rate        | 0.0003    |
|    loss                 | 0.00159   |
|    n_updates            | 650       |
|    policy_gradient_loss | -0.0578   |
|    value_loss           | 1.14e-08  |
---------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 8.1e+03    |
|    ep_rew_mean          | 0          |
| time/                   |            |
|    fps                  | 69         |
|    iterations           | 18         |
|    time_elapsed         | 2667       |
|    total_timesteps      | 184320     |
| train/                  |            |
|    approx_kl            | 0.40413713 |
|    clip_fraction        | 0.67       |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.55      |
|    explained_variance   | -4.54      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0922    |
|    n_updates            | 660        |
|    policy_gradient_loss | -0.0695    |
|    value_loss           | 2.17e-08   |
----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 7.73e+03  |
|    ep_rew_mean          | 0         |
| time/                   |           |
|    fps                  | 67        |
|    iterations           | 19        |
|    time_elapsed         | 2863      |
|    total_timesteps      | 194560    |
| train/                  |           |
|    approx_kl            | 0.3720343 |
|    clip_fraction        | 0.669     |
|    clip_range           | 0.2       |
|    entropy_loss         | -3.6      |
|    explained_variance   | -44.4     |
|    learning_rate        | 0.0003    |
|    loss                 | -0.0749   |
|    n_updates            | 670       |
|    policy_gradient_loss | -0.0486   |
|    value_loss           | 9.87e-08  |
---------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 7.65e+03   |
|    ep_rew_mean          | 0          |
| time/                   |            |
|    fps                  | 66         |
|    iterations           | 20         |
|    time_elapsed         | 3073       |
|    total_timesteps      | 204800     |
| train/                  |            |
|    approx_kl            | 0.39058334 |
|    clip_fraction        | 0.704      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.71      |
|    explained_variance   | -11        |
|    learning_rate        | 0.0003     |
|    loss                 | -0.108     |
|    n_updates            | 680        |
|    policy_gradient_loss | -0.0809    |
|    value_loss           | 1.8e-08    |
----------------------------------------
Traceback (most recent call last):
  File "/home/dang/.local/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-5-b3de8798aee2>", line 29, in <module>
    model.learn(total_timesteps=2000000)  # 2m steps is about 8h at 70 FPS
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/stable_baselines3/ppo/ppo.py", line 310, in learn
    reset_num_timesteps=reset_num_timesteps,
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 237, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 162, in step
    return self.step_wait()
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 44, in step_wait
    self.actions[env_idx]
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/gym/wrappers/record_episode_statistics.py", line 23, in step
    observation, reward, done, info = super(RecordEpisodeStatistics, self).step(action)
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/gym/core.py", line 234, in step
    return self.env.step(action)
  File "<ipython-input-2-c42582487110>", line 166, in step
    obs, reward, done, info = self.env.step(action)
  File "/home/dang/anaconda3/envs/mine/lib/python3.7/site-packages/gym/wrappers/time_limit.py", line 16, in step
    observation, reward, done, info = self.env.step(action)
  File "/home/dang/.local/lib/python3.7/site-packages/minerl/env/_singleagent.py", line 31, in step
    obs, rew, done, info = super().step(multi_agent_action)
  File "/home/dang/.local/lib/python3.7/site-packages/minerl/env/_multiagent.py", line 293, in step
    obs = instance.client_socket_recv_message()
  File "/home/dang/.local/lib/python3.7/site-packages/minerl/env/malmo.py", line 458, in client_socket_recv_message
    return comms.recv_message(self.client_socket)
  File "/home/dang/.local/lib/python3.7/site-packages/minerl/env/comms.py", line 63, in recv_message
    lengthbuf = recvall(sock, 4)
  File "/home/dang/.local/lib/python3.7/site-packages/minerl/env/comms.py", line 73, in recvall
    newbuf = sock.recv(count)
KeyboardInterrupt
Out[6]:
deque([{'r': 0.0, 'l': 6818, 't': 7636.517996},
       {'r': 0.0, 'l': 8949, 't': 7782.608079},
       {'r': 0.0, 'l': 8950, 't': 7803.526794},
       {'r': 0.0, 'l': 9369, 't': 7844.978059},
       {'r': 0.0, 'l': 3837, 't': 7954.610429},
       {'r': 0.0, 'l': 17975, 't': 8400.909965},
       {'r': 0.0, 'l': 9360, 't': 8438.850804},
       {'r': 0.0, 'l': 10043, 't': 8518.442169},
       {'r': 0.0, 'l': 1506, 't': 8633.409958},
       {'r': 0.0, 'l': 10240, 't': 8673.974519},
       {'r': 0.0, 'l': 14247, 't': 8846.047646},
       {'r': 0.0, 'l': 3349, 't': 8895.725449},
       {'r': 0.0, 'l': 643, 't': 8916.12394},
       {'r': 0.0, 'l': 9267, 't': 9139.669439},
       {'r': 0.0, 'l': 4610, 't': 9247.162437},
       {'r': 0.0, 'l': 13244, 't': 9405.406731},
       {'r': 0.0, 'l': 4091, 't': 9449.529551},
       {'r': 0.0, 'l': 1492, 't': 9521.902407},
       {'r': 0.0, 'l': 15816, 't': 9758.570254},
       {'r': 0.0, 'l': 644, 't': 9835.008152},
       {'r': 0.0, 'l': 8832, 't': 9889.481959},
       {'r': 0.0, 'l': 6736, 't': 9948.160111},
       {'r': 0.0, 'l': 2314, 't': 10043.493153},
       {'r': 0.0, 'l': 15838, 't': 10103.340941},
       {'r': 0.0, 'l': 2728, 't': 10141.412017},
       {'r': 0.0, 'l': 7936, 't': 10175.175895},
       {'r': 0.0, 'l': 1027, 't': 10259.402234}])
Out[7]: 27
Out[11]: 28
Traceback (most recent call last):
  File "/home/dang/.local/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-12-a32fd77fbd89>", line 1, in <module>
    a = {key: th.as_tensor(_obs[None]).to(0) for (key, _obs) in a.items()}
NameError: name 'a' is not defined
Out[16]: tensor([[-0.0001]], device='cuda:0', grad_fn=<AddmmBackward>)
Out[17]:
tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.6503, 0.0000, 0.0000, 4.6918, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.3683,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 6.4929,
         0.4934, 4.5941, 2.7222, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 8.0794, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000]], device='cuda:0', grad_fn=<ReluBackward0>)
Out[18]:
tensor([[ -4.8081,  -4.0289,  -4.1574,  -6.2427,  -9.3933,  -1.2831,  -3.1068,
          -3.8246,  -3.8932,  -7.5325,  -2.0127,  -6.2965,  -0.8238,  -2.5062,
          -0.8168,  -2.6582,  -1.6118,  -3.5097,  -1.5288,  -1.5246,  -5.6760,
          -6.2368,  -4.2503,   1.2853,  -0.7607,  -2.4446,  -7.5055,  -3.8005,
           1.2293,  -2.3131,  -3.2657,  -0.3641,  -2.9509,  -1.7043,  -1.7902,
          -1.6447,  -2.1727,  -2.6373,  -6.4119,  -2.2600,  -5.1641,  -5.2493,
          -7.6639,  -3.7356,  -5.6314,  -2.7687,  -0.4108,  -8.5759,  -4.9785,
          -4.1460,  -6.7791,  -2.5403,  -3.6985,  -2.5646,  -7.6303,  -1.6044,
          -3.9481,  -3.5853,  -0.7011,  -0.1503,  -8.9275,  -2.1155,  -0.0949,
          -1.5791, -12.1495,  -1.5892, -10.5935,   0.4065,  -2.3613,  -4.1840,
          -6.4660,  -1.4297,  -0.3815,  -6.3553,  -4.1994,  -3.3347,  -2.7562,
          -7.1360,  -2.7948,  -1.5018,  -1.7743,  -2.7878,  -3.8385,  -2.0791,
          -7.1121,  -0.5797,  -1.0827,  -2.6851,  -2.3954,  -2.8377,  -3.2606,
          -6.8667,  -1.6646,  -0.2372,  -4.0711,  -3.6277,  -5.6293]],
       device='cuda:0', grad_fn=<AddmmBackward>)
Out[19]: 5
Out[20]:
array([[[68.],
        [78.],
        [45.],
        [49.],
        [21.]],
       [[52.],
        [11.],
        [51.],
        [19.],
        [49.]],
       [[55.],
        [14.],
        [67.],
        [23.],
        [25.]],
       ...,
       [[ 0.],
        [ 0.],
        [ 0.],
        [ 0.],
        [ 0.]],
       [[ 0.],
        [ 0.],
        [ 0.],
        [ 0.],
        [ 0.]],
       [[ 0.],
        [ 0.],
        [ 0.],
        [ 0.],
        [ 0.]]], dtype=float32)
Out[21]: (2048, 5, 1)
Out[22]: (2048, 5)
Traceback (most recent call last):
  File "/home/dang/.local/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3296, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-23-85acef0150a1>", line 1, in <module>
    model.rollout_buffer.reward
AttributeError: 'DictRolloutBuffer' object has no attribute 'reward'
Out[24]:
array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       ...,
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]], dtype=float32)
